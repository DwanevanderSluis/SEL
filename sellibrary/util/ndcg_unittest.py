from sel.ndcg import NDCG
import logging

handler = logging.StreamHandler()
handler.setFormatter(logging.Formatter('%(asctime)s %(name)-12s %(levelname)-8s %(message)s'))
logger = logging.getLogger(__name__)
logger.addHandler(handler)
logger.propagate = False
logger.setLevel(logging.INFO)


#https://github.com/usnistgov/trec_eval/blob/master/m_ndcg_cut.c
#https://stackoverflow.com/questions/4275825/how-to-evaluate-a-search-retrieval-engine-using-trec-eval
#http://curric.dlib.vt.edu/modDev/package_modules/MidtermModuleTeam5-TRECevalFinal.pdf
# trec was downloaded from here: https://trec.nist.gov/trec_eval/
# and can be run from ~/code/trec_eval.8.1
#
# Example call:
#      ./trec_eval test/qrels.test test/results.test
#


def unit_test_1():
    saliency_by_ent_id_golden = {9282173: 1.0, 186801: 1.67, 721807: 3.0, 31717: 1.0, 5843419: 1.0, 21785: 1.67,
                                 6984: 1.0, 57654: 1.33, 14653: 3.0, 31956: 1.67, 1166971: 1.67, 9239: 2.33, 11867: 1.0,
                                 9317: 2.33, 32293: 1.0, 31743: 2.0, 3434750: 1.0}
    model_saliency_by_enity_id = {14458880: None, 20189185: None, 280582: None, 36360200: None, 14999563: None,
                                  1374224: None, 1636371: None, 538644: None, 931861: None, 10263: None, 10264: None,
                                  30875674: None, 10272: None, 516133: None, 2807861: None, 10143800: None,
                                  20766780: None, 1015869: None, 188480: None, 7905348: None, 309318: None, 30791: None,
                                  36210760: None, 184391: None, 15153223: None, 1323085: None, 18034777: None,
                                  649307: None, 213088: None, 36915300: None, 59493: None, 14352487: None, 192615: None,
                                  20502636: None, 1208429: None, 47124590: None, 6258: None, 12902516: None, 6266: None,
                                  4989070: None, 21244047: None, 63640: None, 3997849: None, 28825: None, 30875: None,
                                  11280540: None, 5329055: None, 18597: None, 59564: None, 10909868: None, 968879: None,
                                  270516: None, 36178106: None, 3569858: None, 352456: None, 266443: None,
                                  10969292: None, 16658638: None, 301264: None, 512209: None, 7190741: None,
                                  6369501: None, 1806558: None, 24963294: None, 237790: None, 53197027: None,
                                  39551204: None, 135396: None, 1009892: None, 43274469: None, 633061: None,
                                  55526: None, 850170: None, 2593019: None, 2836735: None, 53197058: None,
                                  54233347: None, 19804420: None, 53197073: None, 6824210: None, 2269463: None,
                                  53197086: None, 20769: None, 33087778: None, 21184809: None, 53197097: None,
                                  4400: None, 274736: None, 12594: None, 53197107: None, 10548: None, 7360824: None,
                                  14653: None, 23632191: None, 76095: None, 10740034: None, 217410: None, 37197: None,
                                  53197135: None, 24912: None, 4002131: None, 53197146: None, 929786: None,
                                  1202532: None, 498022: None, 170346: None, 1481067: None, 3823981: None, 581997: None,
                                  25166191: None, 825722: None, 2853242: None, 6658429: None, 303486: None,
                                  221570: None, 37257: None, 15624586: None, 42015113: None, 418188: None,
                                  18588045: None, 18831: None, 1460640: None, 16085411: None, 17158563: None,
                                  4708774: None, 18485674: None, 41398698: None, 461227: None, 735661: None,
                                  186801: None, 2181563: None, 3903933: None, 936385: None, 45506: None, 6598: None,
                                  3819977: None, 188874: None, 256461: None, 31185: None, 1212884: None, 244180: None,
                                  68055: None, 381399: None, 588250: None, 1835482: None, 3205596: None, 74202: None,
                                  1923551: None, 188896: None, 872930: None, 7987684: None, 3410409: None, 45547: None,
                                  4612592: None, 207347: None, 434679: None, 6603263: None, 8417792: None,
                                  9679368: None, 5057034: None, 59919: None, 2923028: None, 825876: None, 1096215: None,
                                  330265: None, 55288346: None, 342555: None, 569881: None, 27165: None, 70173: None,
                                  4102689: None, 1413670: None, 772649: None, 41516: None, 31998508: None, 600624: None,
                                  1786418: None, 481843: None, 48919093: None, 1124920: None, 1413688: None,
                                  940606: None, 17138242: None, 164421: None, 481862: None, 5485127: None, 215623: None,
                                  49733: None, 8464970: None, 172627: None, 9097814: None, 1006174: None,
                                  10340960: None, 27839072: None, 981600: None, 1073769: None, 1210990: None,
                                  78449: None, 20912754: None, 285300: None, 602748: None, 2781821: None,
                                  30190204: None, 20216447: None, 13251197: None, 22534789: None, 37514: None,
                                  164491: None, 2132619: None, 666256: None, 45712: None, 1235600: None, 23193: None,
                                  5575322: None, 1886874: None, 193178: None, 5120672: None, 41904805: None,
                                  10921: None, 5368490: None, 30190251: None, 23499436: None, 262830: None,
                                  764593: None, 37555: None, 2263731: None, 14439096: None, 191162: None,
                                  23188155: None, 96957: None, 3050174: None, 10400448: None, 37570: None,
                                  3492548: None, 51913: None, 8286923: None, 68301: None, 770768: None, 156371: None,
                                  17484502: None, 7166679: None, 43934422: None, 23264: None, 19651298: None,
                                  8530659: None, 31197926: None, 6079208: None, 176874: None, 277226: None,
                                  3885807: None, 5673714: None, 7387891: None, 8735481: None, 23298: None,
                                  24439558: None, 18973446: None, 746248: None, 66313: None, 1104650: None,
                                  523029: None, 23321: None, 21277: None, 934685: None, 4713251: None, 1032998: None,
                                  25382: None, 37671: None, 342826: None, 20996916: None, 74549: None, 31507257: None,
                                  28762939: None, 6853440: None, 24214337: None, 383813: None, 2378570: None,
                                  15180: None, 240468: None, 867159: None, 39775: None, 965472: None, 1289059: None,
                                  172911: None, 2610033: None, 20976497: None, 1131381: None, 6163318: None,
                                  1033084: None, 32084864: None, 19335: None, 50342793: None, 3333002: None,
                                  166796: None, 721807: None, 7259027: None, 99221: None, 5034912: None, 3326882: None,
                                  33702: None, 900011: None, 16823212: None, 560047: None, 43232176: None,
                                  49267633: None, 12592050: None, 25523: None, 78768: None, 156593: None,
                                  44653498: None, 17234878: None, 18564030: None, 2032576: None, 47862723: None,
                                  4094917: None, 414662: None, 13255: None, 13256: None, 50123: None, 220108: None,
                                  7451605: None, 521177: None, 56285: None, 9280486: None, 64489: None, 21488: None,
                                  3030004: None, 37678068: None, 31743: None, 1403906: None, 2802690: None, 27656: None,
                                  25613: None, 48146: None, 26782739: None, 27667: None, 31196181: None, 2118680: None,
                                  4746264: None, 24710172: None, 52255: None, 19600416: None, 11299: None, 27683: None,
                                  21544: None, 27691: None, 560173: None, 12653614: None, 42552367: None, 1219638: None,
                                  3103801: None, 44095: None, 2196546: None, 13950019: None, 12313670: None,
                                  1209416: None, 904268: None, 25676: None, 156754: None, 27870301: None, 52318: None,
                                  23247967: None, 9317: None, 990309: None, 3449959: None, 2372712: None,
                                  39079019: None, 2341996: None, 373867: None, 719984: None, 394354: None, 601205: None,
                                  21124213: None, 37706871: None, 56290425: None, 797820: None, 4807814: None,
                                  9958535: None, 55645318: None, 27783: None, 38025: None, 19594: None, 7023754: None,
                                  25197709: None, 13456: None, 17556: None, 2567317: None, 53896353: None, 316577: None,
                                  1187: None, 804004: None, 10976419: None, 707752: None, 54444: None, 45155506: None,
                                  2405556: None, 25784: None, 144572: None, 31934: None, 47914175: None, 11420864: None,
                                  15568065: None, 242883: None, 9418: None, 310477: None, 26864849: None, 23763: None,
                                  197845: None, 16266461: None, 4721890: None, 4721893: None, 4721894: None,
                                  4721895: None, 4721896: None, 4721897: None, 47688938: None, 56551: None,
                                  4721900: None, 402679: None, 39660799: None, 11449599: None, 9472: None, 38147: None,
                                  30088457: None, 24726796: None, 44303: None, 29970: None, 3755288: None, 21785: None,
                                  2041117: None, 146719: None, 55299362: None, 191783: None, 550187: None,
                                  20755755: None, 7475: None, 589108: None, 21773622: None, 2053440: None,
                                  1586498: None, 36164: None, 167240: None, 13645: None, 652623: None, 4433232: None,
                                  7886159: None, 30598480: None, 58708: None, 2794840: None, 56668: None,
                                  14163295: None, 4191587: None, 7534: None, 701807: None, 26670460: None,
                                  17423741: None, 419202: None, 11107716: None, 26051975: None, 159112: None,
                                  9611: None, 3691915: None, 38286: None, 949651: None, 1594771: None, 538005: None,
                                  12547481: None, 1193370: None, 30856603: None, 22648231: None, 9643: None,
                                  31284652: None, 1615289: None, 52786620: None, 4584893: None, 292285: None,
                                  6231489: None, 28235201: None, 144834: None, 1316305: None, 55616979: None,
                                  1351125: None, 390616: None, 50650: None, 220636: None, 19944: None, 194031: None,
                                  8656370: None, 10257908: None, 54773: None, 67064: None, 2831867: None, 996863: None,
                                  177666: None, 3753477: None, 13831: None, 4568585: None, 2119179: None,
                                  21859852: None, 13227535: None, 204304: None, 267793: None, 1230354: None,
                                  23105042: None, 5649: None, 58900: None, 155160: None, 6231577: None, 349722: None,
                                  1062429: None, 5665: None, 2061866: None, 26156: None, 11826: None, 550451: None,
                                  23488052: None, 603702: None, 17481271: None, 37248569: None, 452160: None,
                                  28649025: None, 32325: None, 30125638: None, 5793352: None, 14069323: None,
                                  3075660: None, 429650: None, 2836053: None, 26197: None, 67157: None, 13911: None,
                                  1566294: None, 22107: None, 5115484: None, 2377314: None, 4417124: None, 142948: None,
                                  427627: None, 8300140: None, 437868: None, 194158: None, 55277165: None,
                                  4017776: None, 534127: None, 21243506: None, 11951732: None, 4832885: None,
                                  374388: None, 22133: None, 1988220: None, 22150: None, 22151: None, 40584: None,
                                  42055305: None, 376458: None, 353930: None, 11282061: None, 22158: None, 28305: None,
                                  3704475: None, 609950: None, 20188834: None, 11423396: None, 888488: None,
                                  48850605: None, 585389: None, 403124: None, 55289526: None, 3673785: None,
                                  147130: None, 17659587: None, 288451: None, 46345931: None, 18243283: None,
                                  48852: None, 4589269: None, 24225498: None, 18955999: None, 30432: None,
                                  3434214: None, 26728175: None, 3274480: None, 997107: None, 9424629: None,
                                  23103222: None, 16203515: None, 10036991: None, 864000: None, 472834: None,
                                  175875: None, 15101699: None, 14049029: None, 3659528: None, 270091: None,
                                  182028: None, 18190: None, 1832721: None, 227091: None, 54214421: None, 7959: None,
                                  3591961: None, 8234779: None, 1781534: None, 5285668: None, 27684646: None,
                                  3467050: None, 26920750: None, 15007542: None, 38573880: None, 515898: None,
                                  247613: None, 28478: None, 247616: None, 4677443: None, 22348: None, 20596557: None,
                                  2191185: None, 11958103: None, 31170393: None, 48990: None, 294752: None,
                                  40521574: None, 46950: None, 5924712: None, 26441578: None, 30871406: None,
                                  30707567: None, 5999: None, 147313: None, 10100: None, 20341: None, 161657: None,
                                  24443: None, 2809727: None, 507777: None, 368513: None, 2697091: None, 47458188: None,
                                  9291663: None, 2809746: None, 214934: None, 1429401: None, 49170335: None,
                                  374691: None, 739237: None, 8964008: None, 30826411: None, 3778479: None,
                                  42559409: None, 1267635: None, 106424: None, 2729914: None, 405443: None,
                                  39419849: None, 24698826: None, 14283: None, 1343434: None, 42799055: None,
                                  51162: None, 1757165: None, 1421295: None, 55284: None, 223220: None, 23101430: None,
                                  143350: None, 143352: None, 26614: None, 143354: None, 92149: None}

    ndcg = NDCG()
    dcg, dcgs = ndcg.calc_model_dcg_on_dict(model_saliency_by_enity_id, saliency_by_ent_id_golden)
    logger.info(dcgs)
    logger.info('NCG = %f ', dcg)


def unit_test_2():
    saliency_by_ent_id_golden = [(9282173, 1.0), (31717, 1.0), (5843419, 1.0), (6984, 1.0), (11867, 1.0), (32293, 1.0),
                                 (3434750, 1.0), (57654, 1.33), (186801, 1.67), (21785, 1.67), (31956, 1.67),
                                 (1166971, 1.67), (31743, 2.0), (9239, 2.33), (9317, 2.33), (721807, 3.0), (14653, 3.0)]
    model_saliency_by_enity_id = [(14458880, 0.0), (20189185, 0.0), (280582, 0.0), (36360200, 0.0), (14999563, 0.0),
                                  (1374224, 0.0), (1636371, 0.0), (538644, 0.0), (931861, 0.0), (10263, 0.0),
                                  (10264, 0.0), (30875674, 0.0), (10272, 0.0), (516133, 0.0), (2807861, 0.0),
                                  (10143800, 0.0), (20766780, 0.0), (1015869, 0.0), (188480, 0.0), (7905348, 0.0),
                                  (309318, 0.0), (30791, 0.0), (36210760, 0.0), (184391, 0.0), (15153223, 0.0),
                                  (1323085, 0.0), (18034777, 0.0), (649307, 0.0), (213088, 0.0), (36915300, 0.0),
                                  (59493, 0.0), (14352487, 0.0), (192615, 0.0), (20502636, 0.0), (1208429, 0.0),
                                  (47124590, 0.0), (6258, 0.0), (12902516, 0.0), (6266, 0.0), (4989070, 0.0),
                                  (21244047, 0.0), (63640, 0.0), (3997849, 0.0), (28825, 0.0), (30875, 0.0),
                                  (11280540, 0.0), (5329055, 0.0), (18597, 0.0), (59564, 0.0), (10909868, 0.0),
                                  (968879, 0.0), (270516, 0.0), (36178106, 0.0), (3569858, 0.0), (352456, 0.0),
                                  (266443, 0.0), (10969292, 0.0), (16658638, 0.0), (301264, 0.0), (512209, 0.0),
                                  (7190741, 0.0), (6369501, 0.0), (1806558, 0.0), (24963294, 0.0), (237790, 0.0),
                                  (53197027, 0.0), (39551204, 0.0), (135396, 0.0), (1009892, 0.0), (43274469, 0.0),
                                  (633061, 0.0), (55526, 0.0), (850170, 0.0), (2593019, 0.0), (2836735, 0.0),
                                  (53197058, 0.0), (54233347, 0.0), (19804420, 0.0), (53197073, 0.0), (6824210, 0.0),
                                  (2269463, 0.0), (53197086, 0.0), (20769, 0.0), (33087778, 0.0), (21184809, 0.0),
                                  (53197097, 0.0), (4400, 0.0), (274736, 0.0), (12594, 0.0), (53197107, 0.0),
                                  (10548, 0.0), (7360824, 0.0), (14653, 0.0), (23632191, 0.0), (76095, 0.0),
                                  (10740034, 0.0), (217410, 0.0), (37197, 0.0), (53197135, 0.0), (24912, 0.0),
                                  (4002131, 0.0), (53197146, 0.0), (929786, 0.0), (1202532, 0.0), (498022, 0.0),
                                  (170346, 0.0), (1481067, 0.0), (3823981, 0.0), (581997, 0.0), (25166191, 0.0),
                                  (825722, 0.0), (2853242, 0.0), (6658429, 0.0), (303486, 0.0), (221570, 0.0),
                                  (37257, 0.0), (15624586, 0.0), (42015113, 0.0), (418188, 0.0), (18588045, 0.0),
                                  (18831, 0.0), (1460640, 0.0), (16085411, 0.0), (17158563, 0.0), (4708774, 0.0),
                                  (18485674, 0.0), (41398698, 0.0), (461227, 0.0), (735661, 0.0), (186801, 0.0),
                                  (2181563, 0.0), (3903933, 0.0), (936385, 0.0), (45506, 0.0), (6598, 0.0),
                                  (3819977, 0.0), (188874, 0.0), (256461, 0.0), (31185, 0.0), (1212884, 0.0),
                                  (244180, 0.0), (68055, 0.0), (381399, 0.0), (588250, 0.0), (1835482, 0.0),
                                  (3205596, 0.0), (74202, 0.0), (1923551, 0.0), (188896, 0.0), (872930, 0.0),
                                  (7987684, 0.0), (3410409, 0.0), (45547, 0.0), (4612592, 0.0), (207347, 0.0),
                                  (434679, 0.0), (6603263, 0.0), (8417792, 0.0), (9679368, 0.0), (5057034, 0.0),
                                  (59919, 0.0), (2923028, 0.0), (825876, 0.0), (1096215, 0.0), (330265, 0.0),
                                  (55288346, 0.0), (342555, 0.0), (569881, 0.0), (27165, 0.0), (70173, 0.0),
                                  (4102689, 0.0), (1413670, 0.0), (772649, 0.0), (41516, 0.0), (31998508, 0.0),
                                  (600624, 0.0), (1786418, 0.0), (481843, 0.0), (48919093, 0.0), (1124920, 0.0),
                                  (1413688, 0.0), (940606, 0.0), (17138242, 0.0), (164421, 0.0), (481862, 0.0),
                                  (5485127, 0.0), (215623, 0.0), (49733, 0.0), (8464970, 0.0), (172627, 0.0),
                                  (9097814, 0.0), (1006174, 0.0), (10340960, 0.0), (27839072, 0.0), (981600, 0.0),
                                  (1073769, 0.0), (1210990, 0.0), (78449, 0.0), (20912754, 0.0), (285300, 0.0),
                                  (602748, 0.0), (2781821, 0.0), (30190204, 0.0), (20216447, 0.0), (13251197, 0.0),
                                  (22534789, 0.0), (37514, 0.0), (164491, 0.0), (2132619, 0.0), (666256, 0.0),
                                  (45712, 0.0), (1235600, 0.0), (23193, 0.0), (5575322, 0.0), (1886874, 0.0),
                                  (193178, 0.0), (5120672, 0.0), (41904805, 0.0), (10921, 0.0), (5368490, 0.0),
                                  (30190251, 0.0), (23499436, 0.0), (262830, 0.0), (764593, 0.0), (37555, 0.0),
                                  (2263731, 0.0), (14439096, 0.0), (191162, 0.0), (23188155, 0.0), (96957, 0.0),
                                  (3050174, 0.0), (10400448, 0.0), (37570, 0.0), (3492548, 0.0), (51913, 0.0),
                                  (8286923, 0.0), (68301, 0.0), (770768, 0.0), (156371, 0.0), (17484502, 0.0),
                                  (7166679, 0.0), (43934422, 0.0), (23264, 0.0), (19651298, 0.0), (8530659, 0.0),
                                  (31197926, 0.0), (6079208, 0.0), (176874, 0.0), (277226, 0.0), (3885807, 0.0),
                                  (5673714, 0.0), (7387891, 0.0), (8735481, 0.0), (23298, 0.0), (24439558, 0.0),
                                  (18973446, 0.0), (746248, 0.0), (66313, 0.0), (1104650, 0.0), (523029, 0.0),
                                  (23321, 0.0), (21277, 0.0), (934685, 0.0), (4713251, 0.0), (1032998, 0.0),
                                  (25382, 0.0), (37671, 0.0), (342826, 0.0), (20996916, 0.0), (74549, 0.0),
                                  (31507257, 0.0), (28762939, 0.0), (6853440, 0.0), (24214337, 0.0), (383813, 0.0),
                                  (2378570, 0.0), (15180, 0.0), (240468, 0.0), (867159, 0.0), (39775, 0.0),
                                  (965472, 0.0), (1289059, 0.0), (172911, 0.0), (2610033, 0.0), (20976497, 0.0),
                                  (1131381, 0.0), (6163318, 0.0), (1033084, 0.0), (32084864, 0.0), (19335, 0.0),
                                  (50342793, 0.0), (3333002, 0.0), (166796, 0.0), (721807, 0.0), (7259027, 0.0),
                                  (99221, 0.0), (5034912, 0.0), (3326882, 0.0), (33702, 0.0), (900011, 0.0),
                                  (16823212, 0.0), (560047, 0.0), (43232176, 0.0), (49267633, 0.0), (12592050, 0.0),
                                  (25523, 0.0), (78768, 0.0), (156593, 0.0), (44653498, 0.0), (17234878, 0.0),
                                  (18564030, 0.0), (2032576, 0.0), (47862723, 0.0), (4094917, 0.0), (414662, 0.0),
                                  (13255, 0.0), (13256, 0.0), (50123, 0.0), (220108, 0.0), (7451605, 0.0),
                                  (521177, 0.0), (56285, 0.0), (9280486, 0.0), (64489, 0.0), (21488, 0.0),
                                  (3030004, 0.0), (37678068, 0.0), (31743, 0.0), (1403906, 0.0), (2802690, 0.0),
                                  (27656, 0.0), (25613, 0.0), (48146, 0.0), (26782739, 0.0), (27667, 0.0),
                                  (31196181, 0.0), (2118680, 0.0), (4746264, 0.0), (24710172, 0.0), (52255, 0.0),
                                  (19600416, 0.0), (11299, 0.0), (27683, 0.0), (21544, 0.0), (27691, 0.0),
                                  (560173, 0.0), (12653614, 0.0), (42552367, 0.0), (1219638, 0.0), (3103801, 0.0),
                                  (44095, 0.0), (2196546, 0.0), (13950019, 0.0), (12313670, 0.0), (1209416, 0.0),
                                  (904268, 0.0), (25676, 0.0), (156754, 0.0), (27870301, 0.0), (52318, 0.0),
                                  (23247967, 0.0), (9317, 0.0), (990309, 0.0), (3449959, 0.0), (2372712, 0.0),
                                  (39079019, 0.0), (2341996, 0.0), (373867, 0.0), (719984, 0.0), (394354, 0.0),
                                  (601205, 0.0), (21124213, 0.0), (37706871, 0.0), (56290425, 0.0), (797820, 0.0),
                                  (4807814, 0.0), (9958535, 0.0), (55645318, 0.0), (27783, 0.0), (38025, 0.0),
                                  (19594, 0.0), (7023754, 0.0), (25197709, 0.0), (13456, 0.0), (17556, 0.0),
                                  (2567317, 0.0), (53896353, 0.0), (316577, 0.0), (1187, 0.0), (804004, 0.0),
                                  (10976419, 0.0), (707752, 0.0), (54444, 0.0), (45155506, 0.0), (2405556, 0.0),
                                  (25784, 0.0), (144572, 0.0), (31934, 0.0), (47914175, 0.0), (11420864, 0.0),
                                  (15568065, 0.0), (242883, 0.0), (9418, 0.0), (310477, 0.0), (26864849, 0.0),
                                  (23763, 0.0), (197845, 0.0), (16266461, 0.0), (4721890, 0.0), (4721893, 0.0),
                                  (4721894, 0.0), (4721895, 0.0), (4721896, 0.0), (4721897, 0.0), (47688938, 0.0),
                                  (56551, 0.0), (4721900, 0.0), (402679, 0.0), (39660799, 0.0), (11449599, 0.0),
                                  (9472, 0.0), (38147, 0.0), (30088457, 0.0), (24726796, 0.0), (44303, 0.0),
                                  (29970, 0.0), (3755288, 0.0), (21785, 0.0), (2041117, 0.0), (146719, 0.0),
                                  (55299362, 0.0), (191783, 0.0), (550187, 0.0), (20755755, 0.0), (7475, 0.0),
                                  (589108, 0.0), (21773622, 0.0), (2053440, 0.0), (1586498, 0.0), (36164, 0.0),
                                  (167240, 0.0), (13645, 0.0), (652623, 0.0), (4433232, 0.0), (7886159, 0.0),
                                  (30598480, 0.0), (58708, 0.0), (2794840, 0.0), (56668, 0.0), (14163295, 0.0),
                                  (4191587, 0.0), (7534, 0.0), (701807, 0.0), (26670460, 0.0), (17423741, 0.0),
                                  (419202, 0.0), (11107716, 0.0), (26051975, 0.0), (159112, 0.0), (9611, 0.0),
                                  (3691915, 0.0), (38286, 0.0), (949651, 0.0), (1594771, 0.0), (538005, 0.0),
                                  (12547481, 0.0), (1193370, 0.0), (30856603, 0.0), (22648231, 0.0), (9643, 0.0),
                                  (31284652, 0.0), (1615289, 0.0), (52786620, 0.0), (4584893, 0.0), (292285, 0.0),
                                  (6231489, 0.0), (28235201, 0.0), (144834, 0.0), (1316305, 0.0), (55616979, 0.0),
                                  (1351125, 0.0), (390616, 0.0), (50650, 0.0), (220636, 0.0), (19944, 0.0),
                                  (194031, 0.0), (8656370, 0.0), (10257908, 0.0), (54773, 0.0), (67064, 0.0),
                                  (2831867, 0.0), (996863, 0.0), (177666, 0.0), (3753477, 0.0), (13831, 0.0),
                                  (4568585, 0.0), (2119179, 0.0), (21859852, 0.0), (13227535, 0.0), (204304, 0.0),
                                  (267793, 0.0), (1230354, 0.0), (23105042, 0.0), (5649, 0.0), (58900, 0.0),
                                  (155160, 0.0), (6231577, 0.0), (349722, 0.0), (1062429, 0.0), (5665, 0.0),
                                  (2061866, 0.0), (26156, 0.0), (11826, 0.0), (550451, 0.0), (23488052, 0.0),
                                  (603702, 0.0), (17481271, 0.0), (37248569, 0.0), (452160, 0.0), (28649025, 0.0),
                                  (32325, 0.0), (30125638, 0.0), (5793352, 0.0), (14069323, 0.0), (3075660, 0.0),
                                  (429650, 0.0), (2836053, 0.0), (26197, 0.0), (67157, 0.0), (13911, 0.0),
                                  (1566294, 0.0), (22107, 0.0), (5115484, 0.0), (2377314, 0.0), (4417124, 0.0),
                                  (142948, 0.0), (427627, 0.0), (8300140, 0.0), (437868, 0.0), (194158, 0.0),
                                  (55277165, 0.0), (4017776, 0.0), (534127, 0.0), (21243506, 0.0), (11951732, 0.0),
                                  (4832885, 0.0), (374388, 0.0), (22133, 0.0), (1988220, 0.0), (22150, 0.0),
                                  (22151, 0.0), (40584, 0.0), (42055305, 0.0), (376458, 0.0), (353930, 0.0),
                                  (11282061, 0.0), (22158, 0.0), (28305, 0.0), (3704475, 0.0), (609950, 0.0),
                                  (20188834, 0.0), (11423396, 0.0), (888488, 0.0), (48850605, 0.0), (585389, 0.0),
                                  (403124, 0.0), (55289526, 0.0), (3673785, 0.0), (147130, 0.0), (17659587, 0.0),
                                  (288451, 0.0), (46345931, 0.0), (18243283, 0.0), (48852, 0.0), (4589269, 0.0),
                                  (24225498, 0.0), (18955999, 0.0), (30432, 0.0), (3434214, 0.0), (26728175, 0.0),
                                  (3274480, 0.0), (997107, 0.0), (9424629, 0.0), (23103222, 0.0), (16203515, 0.0),
                                  (10036991, 0.0), (864000, 0.0), (472834, 0.0), (175875, 0.0), (15101699, 0.0),
                                  (14049029, 0.0), (3659528, 0.0), (270091, 0.0), (182028, 0.0), (18190, 0.0),
                                  (1832721, 0.0), (227091, 0.0), (54214421, 0.0), (7959, 0.0), (3591961, 0.0),
                                  (8234779, 0.0), (1781534, 0.0), (5285668, 0.0), (27684646, 0.0), (3467050, 0.0),
                                  (26920750, 0.0), (15007542, 0.0), (38573880, 0.0), (515898, 0.0), (247613, 0.0),
                                  (28478, 0.0), (247616, 0.0), (4677443, 0.0), (22348, 0.0), (20596557, 0.0),
                                  (2191185, 0.0), (11958103, 0.0), (31170393, 0.0), (48990, 0.0), (294752, 0.0),
                                  (40521574, 0.0), (46950, 0.0), (5924712, 0.0), (26441578, 0.0), (30871406, 0.0),
                                  (30707567, 0.0), (5999, 0.0), (147313, 0.0), (10100, 0.0), (20341, 0.0),
                                  (161657, 0.0), (24443, 0.0), (2809727, 0.0), (507777, 0.0), (368513, 0.0),
                                  (2697091, 0.0), (47458188, 0.0), (9291663, 0.0), (2809746, 0.0), (214934, 0.0),
                                  (1429401, 0.0), (49170335, 0.0), (374691, 0.0), (739237, 0.0), (8964008, 0.0),
                                  (30826411, 0.0), (3778479, 0.0), (42559409, 0.0), (1267635, 0.0), (106424, 0.0),
                                  (2729914, 0.0), (405443, 0.0), (39419849, 0.0), (24698826, 0.0), (14283, 0.0),
                                  (1343434, 0.0), (42799055, 0.0), (51162, 0.0), (1757165, 0.0), (1421295, 0.0),
                                  (55284, 0.0), (223220, 0.0), (23101430, 0.0), (143350, 0.0), (143352, 0.0),
                                  (26614, 0.0), (143354, 0.0), (92149, 0.0)]

    ndcg = NDCG()
    normalised_dcg, discount_sum, max_discount_sum, model_dcgs = ndcg.calc_model_dcg_on_list(model_saliency_by_enity_id, saliency_by_ent_id_golden)
    logger.info(normalised_dcg)
    logger.info('NDCG = %f ', normalised_dcg)



def unit_test_3():
    saliency_by_ent_id_golden = [(3, 3.0), (2, 3.0)]
    model_saliency_by_enity_id = [(3, 3.0), (2, 3.0)]

    ndcg = NDCG()
    normalised_dcg, discount_sum, max_discount_sum, model_dcgs = ndcg.calc_model_dcg_on_list(model_saliency_by_enity_id, saliency_by_ent_id_golden)
    logger.info(normalised_dcg)
    logger.info('NDCG = %f ', normalised_dcg)
    assert(normalised_dcg == 1)

def unit_test_4():
    saliency_by_ent_id_golden = [(3, 3.0), (2, 3.0)]
    model_saliency_by_enity_id = [(3, 2.0), (2, 2.0)]
    ndcg = NDCG()
    normalised_dcg, discount_sum, max_discount_sum, model_dcgs = ndcg.calc_model_dcg_on_list(model_saliency_by_enity_id, saliency_by_ent_id_golden)
    logger.info(normalised_dcg)
    logger.info('NDCG = %f ', normalised_dcg)
    assert(abs(normalised_dcg - 0.428571428571) < 0.000001)


if __name__ == "__main__":
    unit_test_3()
    unit_test_4()
