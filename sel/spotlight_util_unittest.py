from sel.spotlight_util import SpotlightUtil





def unit_test_1():
    su = SpotlightUtil()
    html = '<div><a about="http://dbpedia.org/resource/President_of_the_United_States" href="http://dbpedia.org/resource/President_of_the_United_States" title="http://dbpedia.org/resource/President_of_the_United_States" target="_blank" >President</a> <a about="http://dbpedia.org/resource/Michelle_Obama" typeof="http://dbpedia.org/ontology/Agent" href="http://dbpedia.org/resource/Michelle_Obama" title="http://dbpedia.org/resource/Michelle_Obama">Michelle Obama</a> called Thursday</div>'
    text, spots = su.post_process_html(html)
    assert(len(spots) == 2)
    assert(text == 'President Michelle Obama called Thursday')
    assert(spots[0].entity_id == 24113)

def unit_test_2():
    su = SpotlightUtil()
    html = '<div> ' \
           '<a  href="http://dbpedia.org/resource/Elizabeth_II" >Queen Eliz<a   href="http://dbpedia.org/resource/Elizabeth_II" >Elizabeth II</a> bla bla bla  <a  href="http://dbpedia.org/resource/Foot_Guards"  target="_blank" >Foot Guards</a>. ' \
           '</div>'
    text, spots = su.post_process_html(html)
    assert(len(spots) == 3)
    assert(spots[0].entity_id == 6088192)
    assert(spots[1].entity_id == 6088192)
    assert(spots[2].entity_id == 488105)


def unit_test_3():
    su = SpotlightUtil()
    html = '<h1>Proxy Error</h1><p>The proxy server received an invalidresponse from an upstream server.<br />The proxy server could not handle the request <em><a href="/en/annotate">GET&nbsp;/en/annotate</a></em>.<p> Reason: <strong>Error reading from remote server</strong></p></p>'
    text, spots = su.post_process_html(html)


def exercise_1():
    su = SpotlightUtil()
    html = ' <div> <a about="http://dbpedia.org/resource/Renault_in_Formula_One" typeof="http://dbpedia.org/ontology/Agent" href="http://dbpedia.org/resource/Renault_in_Formula_One" title="http://dbpedia.org/resource/Renault_in_Formula_One">Renault F1</a> have hit back at their sacked driver <a about="http://dbpedia.org/resource/Nelson_Piquet_Jr." typeof="http://dbpedia.org/ontology/Agent" href="http://dbpedia.org/resource/Nelson_Piquet_Jr." title="http://dbpedia.org/resource/Nelson_Piquet_Jr.">Nelson Piquet Jr.</a> after a leaked transcript of his evidence to the sport\'s governing body revealed he claimed to have been ordered to crash to fix a race. They have taken their case to the police.Renault now has to appear before the <a about="http://dbpedia.org/resource/Federal_Investigation_Agency" href="http://dbpedia.org/resource/Federal_Investigation_Agency" title="http://dbpedia.org/resource/Federal_Investigation_Agency" target="_blank" >FIA</a> on September 21 to answer a race-fixing charge. They have also made a complaint to the <a about="http://dbpedia.org/resource/French_language" typeof="http://dbpedia.org/ontology/Language" href="http://dbpedia.org/resource/French_language" title="http://dbpedia.org/resource/French_language">French</a> police against Piquet and his father <a about="http://dbpedia.org/resource/Nelson_Piquet_Jr." typeof="http://dbpedia.org/ontology/Agent" href="http://dbpedia.org/resource/Nelson_Piquet_Jr." title="http://dbpedia.org/resource/Nelson_Piquet_Jr.">Nelson Piquet</a> Sr., claiming <a about="http://dbpedia.org/resource/Blackmail" href="http://dbpedia.org/resource/Blackmail" title="http://dbpedia.org/resource/Blackmail" target="_blank" >blackmail</a> and false allegations. "<a about="http://dbpedia.org/resource/Renault_in_Formula_One" typeof="http://dbpedia.org/ontology/Agent" href="http://dbpedia.org/resource/Renault_in_Formula_One" title="http://dbpedia.org/resource/Renault_in_Formula_One">Renault F1 Team</a> and its managing director <a about="http://dbpedia.org/resource/Flavio_Briatore" typeof="http://dbpedia.org/ontology/Agent" href="http://dbpedia.org/resource/Flavio_Briatore" title="http://dbpedia.org/resource/Flavio_Briatore">Flavio Briatore</a> have commenced criminal proceedings against <a about="http://dbpedia.org/resource/Nelson_Piquet_Jr." typeof="http://dbpedia.org/ontology/Agent" href="http://dbpedia.org/resource/Nelson_Piquet_Jr." title="http://dbpedia.org/resource/Nelson_Piquet_Jr.">Nelson Piquet Jr.</a> and <a about="http://dbpedia.org/resource/Nelson_Piquet_Jr." typeof="http://dbpedia.org/ontology/Agent" href="http://dbpedia.org/resource/Nelson_Piquet_Jr." title="http://dbpedia.org/resource/Nelson_Piquet_Jr.">Nelson Piquet</a> Sr. concerning the making of false allegations and a related attempt to <a about="http://dbpedia.org/resource/Blackmail" href="http://dbpedia.org/resource/Blackmail" title="http://dbpedia.org/resource/Blackmail" target="_blank" >blackmail</a> the team into allowing <a about="http://dbpedia.org/resource/Nelson_Piquet_Jr." typeof="http://dbpedia.org/ontology/Agent" href="http://dbpedia.org/resource/Nelson_Piquet_Jr." title="http://dbpedia.org/resource/Nelson_Piquet_Jr.">Piquet Jr</a>. to drive for the remainder of the 2009 season. The matter will also be referred to the police in Britain." Piquet Sr. is a three-times former world champion.Piquet Jr. crashed in the <a about="http://dbpedia.org/resource/2008_Singapore_Grand_Prix" typeof="http://dbpedia.org/ontology/Event" href="http://dbpedia.org/resource/2008_Singapore_Grand_Prix" title="http://dbpedia.org/resource/2008_Singapore_Grand_Prix">2008 Sing<a about="http://dbpedia.org/resource/2009_Singapore_Grand_Prix" typeof="http://dbpedia.org/ontology/Event" href="http://dbpedia.org/resource/2009_Singapore_Grand_Prix" title="http://dbpedia.org/resource/2009_Singapore_Grand_Prix">Singapore Grand Prix</a> just after an early pit stop for <a about="http://dbpedia.org/resource/Fernando_Alonso" typeof="http://dbpedia.org/ontology/Agent" href="http://dbpedia.org/resource/Fernando_Alonso" title="http://dbpedia.org/resource/Fernando_Alonso">Fernando Alonso</a>, bringing out the <a about="http://dbpedia.org/resource/Safety_car" href="http://dbpedia.org/resource/Safety_car" title="http://dbpedia.org/resource/Safety_car" target="_blank" >safety car</a>. As the cars ahead of Alonso went in for fuel under the <a about="http://dbpedia.org/resource/Safety_car" href="http://dbpedia.org/resource/Safety_car" title="http://dbpedia.org/resource/Safety_car" target="_blank" >safety car</a>, he moved up the pack to take victory. <a about="http://dbpedia.org/resource/Nelson_Piquet_Jr." typeof="http://dbpedia.org/ontology/Agent" href="http://dbpedia.org/resource/Nelson_Piquet_Jr." title="http://dbpedia.org/resource/Nelson_Piquet_Jr.">Piquet Jr</a>. was sacked after the <a about="http://dbpedia.org/resource/2009_Hungarian_Grand_Prix" typeof="http://dbpedia.org/ontology/Event" href="http://dbpedia.org/resource/2009_Hungarian_Grand_Prix" title="http://dbpedia.org/resource/2009_Hungarian_Grand_Prix">2009 Hung<a about="http://dbpedia.org/resource/2009_Hungarian_Grand_Prix" typeof="http://dbpedia.org/ontology/Event" href="http://dbpedia.org/resource/2009_Hungarian_Grand_Prix" title="http://dbpedia.org/resource/2009_Hungarian_Grand_Prix">Hungarian Grand Prix</a>."I was asked by Mr <a about="http://dbpedia.org/resource/Flavio_Briatore" typeof="http://dbpedia.org/ontology/Agent" href="http://dbpedia.org/resource/Flavio_Briatore" title="http://dbpedia.org/resource/Flavio_Briatore">Flavio Briatore</a> and Mr. <a about="http://dbpedia.org/resource/Pat_Symonds" typeof="http://dbpedia.org/ontology/Agent" href="http://dbpedia.org/resource/Pat_Symonds" title="http://dbpedia.org/resource/Pat_Symonds">Pat Symonds</a> to deliberately crash my car in order to positively influence the performance of the Team at the event," said <a about="http://dbpedia.org/resource/Nelson_Piquet_Jr." typeof="http://dbpedia.org/ontology/Agent" href="http://dbpedia.org/resource/Nelson_Piquet_Jr." title="http://dbpedia.org/resource/Nelson_Piquet_Jr.">Piquet Jr</a>. "I agreed to this proposal and caused my car to hit a wall and crash during lap 13/14 of the race." He added "At the time of this conversation, I was in a very fragile and emotional state of mind - brought about by intense <a about="http://dbpedia.org/resource/Psychological_stress" href="http://dbpedia.org/resource/Psychological_stress" title="http://dbpedia.org/resource/Psychological_stress" target="_blank" >stress</a> due to the fact that Mr Briatore had refused to inform me of whether or not my contract would be renewed for the next racing year." </div> '
    text, spots = su.post_process_html(html)

def exercise_2():
    su = SpotlightUtil()
    html = '<div> A <a about="http://dbpedia.org/resource/Moment_of_silence" href="http://dbpedia.org/resource/Moment_of_silence" title="http://dbpedia.org/resource/Moment_of_silence" target="_blank" >two-minute silence</a> at noon <a about="http://dbpedia.org/resource/British_Summer_Time" href="http://dbpedia.org/resource/British_Summer_Time" title="http://dbpedia.org/resource/British_Summer_Time" target="_blank" >BST</a> has been marked by millions across the <a about="http://dbpedia.org/resource/United_Kingdom" typeof="http://dbpedia.org/ontology/Country" href="http://dbpedia.org/resource/United_Kingdom" title="http://dbpedia.org/resource/United_Kingdom">United Kingdom</a> and the <a about="http://dbpedia.org/resource/European_Union" typeof="http://dbpedia.org/ontology/Country" href="http://dbpedia.org/resource/European_Union" title="http://dbpedia.org/resource/European_Union">European Union</a> to remember those who died last Thursday in the <a about="http://dbpedia.org/resource/London" typeof="http://dbpedia.org/ontology/Location" href="http://dbpedia.org/resource/London" title="http://dbpedia.org/resource/London">London</a> attacks.In <a about="http://dbpedia.org/resource/London" typeof="http://dbpedia.org/ontology/Location" href="http://dbpedia.org/resource/London" title="http://dbpedia.org/resource/London">London</a>, all buses and cabs came to halt, and all people in their offices stood outside. Trains were not stopped but the <a about="http://dbpedia.org/resource/Moment_of_silence" href="http://dbpedia.org/resource/Moment_of_silence" title="http://dbpedia.org/resource/Moment_of_silence" target="_blank" >two-minute silence</a> was announced and marked through the underground and overground services. Aeroplanes delayed their takeoff to respect the two-minute silence.At the bombing sites, wreaths were laid in respect, with hundreds gathering at the sites to mark the silence.At <a about="http://dbpedia.org/resource/Buckingham_Palace" href="http://dbpedia.org/resource/Buckingham_Palace" title="http://dbpedia.org/resource/Buckingham_Palace" target="_blank" >Buckingham Palace</a>, <a about="http://dbpedia.org/resource/Elizabeth_II" typeof="http://dbpedia.org/ontology/Agent" href="http://dbpedia.org/resource/Elizabeth_II" title="http://dbpedia.org/resource/Elizabeth_II">Queen Eliz<a about="http://dbpedia.org/resource/Elizabeth_II" typeof="http://dbpedia.org/ontology/Agent" href="http://dbpedia.org/resource/Elizabeth_II" title="http://dbpedia.org/resource/Elizabeth_II">Elizabeth II</a> stood on the forecourt in silence, accompanied by <a about="http://dbpedia.org/resource/Foot_Guards" href="http://dbpedia.org/resource/Foot_Guards" title="http://dbpedia.org/resource/Foot_Guards" target="_blank" >Foot Guards</a>. <a about="http://dbpedia.org/resource/Prime_Minister_of_the_United_Kingdom" href="http://dbpedia.org/resource/Prime_Minister_of_the_United_Kingdom" title="http://dbpedia.org/resource/Prime_Minister_of_the_United_Kingdom" target="_blank" >Prime Minister</a> <a about="http://dbpedia.org/resource/Tony_Blair" typeof="http://dbpedia.org/ontology/Agent" href="http://dbpedia.org/resource/Tony_Blair" title="http://dbpedia.org/resource/Tony_Blair">Tony Blair</a> marked the silence in the garden of <a about="http://dbpedia.org/resource/10_Downing_Street" typeof="http://dbpedia.org/ontology/ArchitecturalStructure" href="http://dbpedia.org/resource/10_Downing_Street" title="http://dbpedia.org/resource/10_Downing_Street">10 Downing Street</a>, and Mayor of <a about="http://dbpedia.org/resource/London" typeof="http://dbpedia.org/ontology/Location" href="http://dbpedia.org/resource/London" title="http://dbpedia.org/resource/London">London</a> <a about="http://dbpedia.org/resource/Ken_Livingstone" typeof="http://dbpedia.org/ontology/Agent" href="http://dbpedia.org/resource/Ken_Livingstone" title="http://dbpedia.org/resource/Ken_Livingstone">Ken Livingstone</a> paid his respects at <a about="http://dbpedia.org/resource/Battle_of_Trafalgar" typeof="http://dbpedia.org/ontology/Event" href="http://dbpedia.org/resource/Battle_of_Trafalgar" title="http://dbpedia.org/resource/Battle_of_Trafalgar">Trafalgar</a> Square.At The <a about="http://dbpedia.org/resource/The_Open_Championship" typeof="http://dbpedia.org/ontology/Event" href="http://dbpedia.org/resource/The_Open_Championship" title="http://dbpedia.org/resource/The_Open_Championship">Open Championship</a> taking place at <a about="http://dbpedia.org/resource/St_Andrews" typeof="http://dbpedia.org/ontology/Location" href="http://dbpedia.org/resource/St_Andrews" title="http://dbpedia.org/resource/St_Andrews">St Andrews</a>, golfers also paid their respects. <a about="http://dbpedia.org/resource/Yesterday_(Beatles_song)" typeof="http://dbpedia.org/ontology/MusicalWork" href="http://dbpedia.org/resource/Yesterday_(Beatles_song)" title="http://dbpedia.org/resource/Yesterday_(Beatles_song)">Yesterday</a>, <a about="http://dbpedia.org/resource/Anfield" typeof="http://dbpedia.org/ontology/ArchitecturalStructure" href="http://dbpedia.org/resource/Anfield" title="http://dbpedia.org/resource/Anfield">Anfield</a> stadium fell in silence during the Liverpool <a about="http://dbpedia.org/resource/Yorkshire_Carnegie" typeof="http://dbpedia.org/ontology/Agent" href="http://dbpedia.org/resource/Yorkshire_Carnegie" title="http://dbpedia.org/resource/Yorkshire_Carnegie">F.C.</a> vs <a about="http://dbpedia.org/resource/The_New_Saints_F.C." typeof="http://dbpedia.org/ontology/Agent" href="http://dbpedia.org/resource/The_New_Saints_F.C." title="http://dbpedia.org/resource/The_New_Saints_F.C.">TNS</a> UEFA Champios League <a about="http://dbpedia.org/resource/Association_football" typeof="http://dbpedia.org/ontology/Activity" href="http://dbpedia.org/resource/Association_football" title="http://dbpedia.org/resource/Association_football">football</a> match.In <a about="http://dbpedia.org/resource/Paris" typeof="http://dbpedia.org/ontology/Location" href="http://dbpedia.org/resource/Paris" title="http://dbpedia.org/resource/Paris">Paris</a>, <a about="http://dbpedia.org/resource/France" typeof="http://dbpedia.org/ontology/Country" href="http://dbpedia.org/resource/France" title="http://dbpedia.org/resource/France">France</a>, <a about="http://dbpedia.org/resource/President_of_France" href="http://dbpedia.org/resource/President_of_France" title="http://dbpedia.org/resource/President_of_France" target="_blank" >President</a> <a about="http://dbpedia.org/resource/Jacques_Chirac" typeof="http://dbpedia.org/ontology/Agent" href="http://dbpedia.org/resource/Jacques_Chirac" title="http://dbpedia.org/resource/Jacques_Chirac">Jacques Chirac</a> stood in silence at the <a about="http://dbpedia.org/resource/Élysée_Palace" typeof="http://dbpedia.org/ontology/ArchitecturalStructure" href="http://dbpedia.org/resource/Élysée_Palace" title="http://dbpedia.org/resource/Élysée_Palace">Elysee Palace</a> before taking part in the <a about="http://dbpedia.org/resource/Bastille_Day" typeof="http://dbpedia.org/ontology/Holiday" href="http://dbpedia.org/resource/Bastille_Day" title="http://dbpedia.org/resource/Bastille_Day">Bastille Day</a> <a about="http://dbpedia.org/resource/Parade" href="http://dbpedia.org/resource/Parade" title="http://dbpedia.org/resource/Parade" target="_blank" >parade</a>. The <a about="http://dbpedia.org/resource/European_Parliament" typeof="http://dbpedia.org/ontology/Agent" href="http://dbpedia.org/resource/European_Parliament" title="http://dbpedia.org/resource/European_Parliament">European Parliament</a> marked the silence along with <a about="http://dbpedia.org/resource/President_of_the_European_Commission" href="http://dbpedia.org/resource/President_of_the_European_Commission" title="http://dbpedia.org/resource/President_of_the_European_Commission" target="_blank" >European Commission</a> offices across the EU.A <a about="http://dbpedia.org/resource/Vigil" href="http://dbpedia.org/resource/Vigil" title="http://dbpedia.org/resource/Vigil" target="_blank" >vigil</a> will be held in <a about="http://dbpedia.org/resource/Trafalgar_Square" typeof="http://dbpedia.org/ontology/ArchitecturalStructure" href="http://dbpedia.org/resource/Trafalgar_Square" title="http://dbpedia.org/resource/Trafalgar_Square">Trafalgar Square</a>, <a about="http://dbpedia.org/resource/London" typeof="http://dbpedia.org/ontology/Location" href="http://dbpedia.org/resource/London" title="http://dbpedia.org/resource/London">London</a> at 18:00 <a about="http://dbpedia.org/resource/British_Summer_Time" href="http://dbpedia.org/resource/British_Summer_Time" title="http://dbpedia.org/resource/British_Summer_Time" target="_blank" >BST</a> .</div>'
    text, spots = su.post_process_html(html)
    print(su.my_pp(html))


if __name__ == "__main__":

    unit_test_1()
    unit_test_2()
    unit_test_3()

    exercise_1()
    exercise_2()



